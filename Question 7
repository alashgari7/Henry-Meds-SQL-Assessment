SELECT TOP 3 t.CustomerID, t.CustomerName, SUM(t.TotalAmount)AS ‘Total Order Amount’
FROM
(SELECT c.CustomerID, c.CustomerName, SUM(o.TotalAmount) AS 'Total Order Amount'
Orders o
JOIN Customers c
	ON c.CustomerID = o.CustomerID
WHERE o.OrderDate >= DATEADD(M,-3,GETDATE()) 
GROUP BY c.CustomerID
) AS t
ORDER BY SUM(t.TotalAmount) DESC;
